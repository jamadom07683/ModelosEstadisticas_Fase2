---
title: "Encuesta microestablecimientos 2016"
author: 
- David Moreno, Santiago Amado, Yodid Cardenas

 - Maestría en Ciencia de Datos

 - Modelos Estadísticos Aplicados
date: ""
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
  word_document:
    toc: yes
---



```{r echo=FALSE}
# URL actualizada del archivo en GitHub
url <- "https://raw.githubusercontent.com/jamadom07683/ModelosEstadisticas_Fase2/refs/heads/main/Microestablecimientos_2016.csv"

```


```{r echo=FALSE}
# Leer el archivo CSV desde la URL
establecimientos <- read.csv(url,sep = ";")
```


# Contextualización. 
**Contextualización de datos:**

El conjunto de datos de microestablecimientos 2016 se recopila con el objetivo de analizar las características y el desempeño económico de las pequeñas unidades productivas en el país. La base de datos incluye una amplia gama de información que abarca aspectos financieros, laborales y tecnológicos de los microestablecimientos, permitiendo así un análisis detallado de su estructura y comportamiento en el mercado. Las fuentes de información provienen principalmente de encuestas realizadas a los microempresarios y registros administrativos, cubriendo diferentes sectores económicos a nivel nacional. La base de datos cuenta con más de 100 variables que representan desde ingresos anuales hasta el uso de tecnología, como la existencia de una página web.

En términos de cobertura, la base de datos abarca microestablecimientos de diferentes regiones del país, permitiendo así un análisis geográfico y sectorial de los mismos. Las unidades de análisis son los microestablecimientos, definidos como pequeñas empresas que tienen un número limitado de empleados y recursos financieros, pero que representan un sector importante de la economía local. El muestreo utilizado es probabilístico, lo que garantiza que los resultados sean representativos de la población de microestablecimientos a nivel nacional. La información recolectada incluye variables cuantitativas, como los ingresos y gastos, y cualitativas, como el tipo de propiedad o el sector de actividad.

El objetivo del análisis estadístico que presentamos en este informe es identificar patrones de comportamiento entre los microestablecimientos en términos de ingresos, inversión en tecnología y capacidad laboral, con el fin de ofrecer recomendaciones sobre cómo estos negocios pueden mejorar su productividad y sostenibilidad. También se busca entender el impacto de la formalización y la adopción de tecnología en el desempeño de los microestablecimientos, lo que puede ayudar a orientar políticas públicas que fomenten el crecimiento de este sector en la economía.


# Elección de variables.
```{r echo=FALSE}
# Seleccionar las columnas relevantes, reemplazando P3019 por CDGO_DPRTMNTO
variables_seleccionadas <- establecimientos[, c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO")]

# Crear un dataframe con las variables seleccionadas y sus descripciones
tabla_variables <- data.frame(
  "Código DANE" = c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO"),
  "Descripción" = c(
    "Valor total de ventas o ingresos en los últimos 12 meses",
    "El establecimiento tiene página web",
    "Número de computadores de escritorio en uso",
    "Número de computadores portátiles en uso",
    "Mes al que corresponde el valor reportado",
    "Dispositivos PDA/DMC en uso en el establecimiento",
    "Acceso o uso del servicio de Internet en el establecimiento",
    "Uso de Internet dentro del establecimiento",
    "Actividades en las que el establecimiento utiliza Internet",
    "Formas de pago que acepta el establecimiento",
    "Uso de Internet fuera del establecimiento",
    "Código de departamento del establecimiento"
  )
)

# Mostrar la tabla
print(tabla_variables)

```
# Justificacion de Variables

Hemos seleccionado estas 12 variables porque consideramos que nos ofrecen una visión integral del desempeño de los microestablecimientos en Colombia.
A continuación, explicamos cada una y su relevancia en el análisis.

**P1010 (Ventas o ingresos en los últimos 12 meses):** Es clave para medir el desempeño financiero de los establecimientos.

**P2532 (Página web):** Evaluamos la adopción tecnológica, importante para la visibilidad y competitividad.

**P1087 (Computadores de escritorio):** Reflejan el nivel tecnológico disponible.

**P1088 (Computadores portátiles):** Reflejan el nivel tecnológico disponible.

**P1057 (Mes de referencia):** Nos ayuda a contextualizar los datos financieros.

**P1092 (Dispositivos PDA/DMC):** Mide el uso de dispositivos tecnológicos avanzados.

**P2524 (Acceso a Internet):** Fundamental para analizar la modernización del negocio.

**P1093 (Uso de Internet dentro del establecimiento):** Permiten evaluar la conectividad y productividad.

**P1094 (Uso fuera del establecimiento):** Permiten evaluar la conectividad y productividad.

**P1006 (Uso de Internet en actividades clave):** Nos permite conocer cómo la tecnología se integra en las operaciones diarias.

**P1764 (Formas de pago):** Es crucial para analizar la capacidad del establecimiento de gestionar transacciones modernas.

**CDGO_DPRTMNTO (Código de departamento):** Ayuda a contextualizar geográficamente los establecimientos, permitiendo análisis regionales (por ejemplo, el costo de la energía eléctrica).


# Análisis descriptivo.
```{r echo=FALSE}
```
# Distribución del total de ventas o ingresos.
```{r echo=FALSE}
# Definir la función para graficar la distribución
graficar_distribucion <- function(datos, titulo) {
  # Crear el histograma
  hist(datos$P1010, prob = TRUE, main = titulo, xlab = "Ventas o ingresos", col = "lightblue", breaks = 30)
  
  # Añadir la curva de densidad
  lines(density(datos$P1010, na.rm = TRUE), col = "red", lwd = 2)
  
  # Añadir la curva de distribución normal
  media <- mean(datos$P1010, na.rm = TRUE)
  sd <- sd(datos$P1010, na.rm = TRUE)
  curve(dnorm(x, mean = media, sd = sd), add = TRUE, col = "blue", lwd = 2)
}

# Filtrar los datos para ventas menores a 100 millones
datos_filtrados <- variables_seleccionadas[variables_seleccionadas$P1010 < 100000000, ]

# Verificar si los datos filtrados tienen alguna fila
if (nrow(datos_filtrados) > 0) {
  
  # Filtrar los que NO tienen página web
  sin_web <- datos_filtrados[datos_filtrados$P2532 == 0, ]
  
  # Filtrar los que SÍ tienen página web
  con_web <- datos_filtrados[datos_filtrados$P2532 == 1, ]
  
  # Verificar si el subconjunto sin_web tiene datos y no está vacío
  if (nrow(sin_web) > 0 && sum(!is.na(sin_web$P1010)) > 0) {
    graficar_distribucion(sin_web, "Distribución de Ventas (Sin Página Web)")
  } else {
    print("No hay datos suficientes para los establecimientos sin página web.")
  }
  
  # Verificar si el subconjunto con_web tiene datos y no está vacío
  if (nrow(con_web) > 0 && sum(!is.na(con_web$P1010)) > 0) {
    graficar_distribucion(con_web, "Distribución de Ventas (Con Página Web)")
  } else {
    print("No hay datos suficientes para los establecimientos con página web.")
  }
  
} else {
  print("No hay datos suficientes después del filtrado.")
}
```

# Estimaciones.
```{r echo=FALSE}
# Remover los valores NA para la columna P1010
ventas <- na.omit(variables_seleccionadas$P1010)

# Cálculo del promedio y desviación estándar
promedio_ventas <- mean(ventas)
desviacion_ventas <- sd(ventas)

# Tamaño de la muestra
n_ventas <- length(ventas)

# Error estándar del promedio
error_estandar_ventas <- desviacion_ventas / sqrt(n_ventas)
error_margen_ventas <- qnorm(0.975) * error_estandar_ventas

# Intervalo de confianza
limite_inferior_ventas <- promedio_ventas - error_margen_ventas
limite_superior_ventas <- promedio_ventas + error_margen_ventas

# Mostrar el intervalo de confianza
cat("Intervalo de confianza para el promedio de ventas (95%): [", limite_inferior_ventas, ", ", limite_superior_ventas, "]\n")

print("Proporción de microestablecimientos que cuentan con página web")

# Convertir la columna P2532 a 0 y 1 si no está ya en ese formato
variables_seleccionadas$P2532 <- as.numeric(variables_seleccionadas$P2532 == 1)

# Remover valores NA para la columna P2532
pagina_web <- na.omit(variables_seleccionadas$P2532)

# Cálculo de la proporción de establecimientos con página web
proporcion_web <- mean(pagina_web)

# Tamaño de la muestra
n_web <- length(pagina_web)

# Comprobar si la proporción es 0 o 1 para evitar errores
if (proporcion_web == 0) {
  limite_inferior_web <- 0
  limite_superior_web <- 0
} else if (proporcion_web == 1) {
  limite_inferior_web <- 1
  limite_superior_web <- 1
} else {
  # Error estándar de la proporción
  error_estandar_web <- sqrt(proporcion_web * (1 - proporcion_web) / n_web)
  
  # Intervalo de confianza del 95% para la proporción
  error_margen_web <- qnorm(0.975) * error_estandar_web
  
  # Intervalo de confianza
  limite_inferior_web <- proporcion_web - error_margen_web
  limite_superior_web <- proporcion_web + error_margen_web
}

# Mostrar el intervalo de confianza
cat("Intervalo de confianza para la proporción de establecimientos con página web (95%): [", limite_inferior_web, ", ", limite_superior_web, "]\n")



print("Estimación del número de computadores de escritorio")

# Remover valores NA para la columna P1087
computadores_escritorio <- na.omit(variables_seleccionadas$P1087)

# Cálculo del promedio y desviación estándar
promedio_computadores_escritorio <- mean(computadores_escritorio)
desviacion_computadores_escritorio <- sd(computadores_escritorio)

# Tamaño de la muestra
n_computadores_escritorio <- length(computadores_escritorio)

# Error estándar del promedio
error_estandar_computadores_escritorio <- desviacion_computadores_escritorio / sqrt(n_computadores_escritorio)
error_margen_computadores_escritorio <- qnorm(0.975) * error_estandar_computadores_escritorio

# Intervalo de confianza
limite_inferior_computadores_escritorio <- promedio_computadores_escritorio - error_margen_computadores_escritorio
limite_superior_computadores_escritorio <- promedio_computadores_escritorio + error_margen_computadores_escritorio

# Mostrar el intervalo de confianza
cat("Intervalo de confianza para el número de computadores de escritorio (95%): [", limite_inferior_computadores_escritorio, ", ", limite_superior_computadores_escritorio, "]\n")

print("Estimación del número de computadores portátiles")

# Remover valores NA para la columna P1088
computadores_portatiles <- na.omit(variables_seleccionadas$P1088)

# Cálculo del promedio y desviación estándar
promedio_computadores_portatiles <- mean(computadores_portatiles)
desviacion_computadores_portatiles <- sd(computadores_portatiles)

# Tamaño de la muestra
n_computadores_portatiles <- length(computadores_portatiles)

# Error estándar del promedio
error_estandar_computadores_portatiles <- desviacion_computadores_portatiles / sqrt(n_computadores_portatiles)
error_margen_computadores_portatiles <- qnorm(0.975) * error_estandar_computadores_portatiles

# Intervalo de confianza
limite_inferior_computadores_portatiles <- promedio_computadores_portatiles - error_margen_computadores_portatiles
limite_superior_computadores_portatiles <- promedio_computadores_portatiles + error_margen_computadores_portatiles

# Mostrar el intervalo de confianza
cat("Intervalo de confianza para el número de computadores portátiles (95%): [", limite_inferior_computadores_portatiles, ", ", limite_superior_computadores_portatiles, "]\n")

```

# Estrategías.

# Limitaciones u oportunidades.

# Referencias.
