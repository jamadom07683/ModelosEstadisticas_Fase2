---
title: "Encuesta microestablecimientos 2016"
author: 
- David Moreno, Santiago Amado, Yodid Cardenas

 - Maestría en Ciencia de Datos

 - Modelos Estadísticos Aplicados
date: ""
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
  word_document:
    toc: yes
---



```{r echo=FALSE, message=FALSE, warning=FALSE}

# Instalar ggplot2 si no está instalado
if(!require(ggplot2)) install.packages("ggplot2", dependencies=TRUE)
# Instalar y cargar RColorBrewer si no está instalado
if (!require(RColorBrewer)) {
  install.packages("RColorBrewer")
}
library(RColorBrewer)

# Instalar y cargar el paquete dplyr si no está instalado
if (!require(dplyr)) {
  install.packages("dplyr")
}
library(dplyr)

# URL actualizada del archivo en GitHub
url <- "https://raw.githubusercontent.com/jamadom07683/ModelosEstadisticas_Fase2/refs/heads/main/Microestablecimientos_2016.csv"

```


```{r echo=FALSE}
# Leer el archivo CSV desde la URL
establecimientos <- read.csv(url,sep = ";")
```


# Contextualización. 
**Contextualización de datos:**

El conjunto de datos de microestablecimientos 2016 se recopila con el objetivo de analizar las características y el desempeño económico de las pequeñas unidades productivas en el país. La base de datos incluye una amplia gama de información que abarca aspectos financieros, laborales y tecnológicos de los microestablecimientos, permitiendo así un análisis detallado de su estructura y comportamiento en el mercado. Las fuentes de información provienen principalmente de encuestas realizadas a los microempresarios y registros administrativos, cubriendo diferentes sectores económicos a nivel nacional. La base de datos cuenta con más de 100 variables que representan desde ingresos anuales hasta el uso de tecnología, como la existencia de una página web.

En términos de cobertura, la base de datos abarca microestablecimientos de diferentes regiones del país, permitiendo así un análisis geográfico y sectorial de los mismos. Las unidades de análisis son los microestablecimientos, definidos como pequeñas empresas que tienen un número limitado de empleados y recursos financieros, pero que representan un sector importante de la economía local. El muestreo utilizado es probabilístico, lo que garantiza que los resultados sean representativos de la población de microestablecimientos a nivel nacional. La información recolectada incluye variables cuantitativas, como los ingresos y gastos, y cualitativas, como el tipo de propiedad o el sector de actividad.

El objetivo del análisis estadístico que presentamos en este informe es identificar patrones de comportamiento entre los microestablecimientos en términos de ingresos, inversión en tecnología y capacidad laboral, con el fin de ofrecer recomendaciones sobre cómo estos negocios pueden mejorar su productividad y sostenibilidad. También se busca entender el impacto de la formalización y la adopción de tecnología en el desempeño de los microestablecimientos, lo que puede ayudar a orientar políticas públicas que fomenten el crecimiento de este sector en la economía.


# Elección de variables.
```{r echo=FALSE}
# Seleccionar las columnas relevantes, reemplazando P3019 por CDGO_DPRTMNTO
variables_seleccionadas <- establecimientos[, c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO")]

# Crear un dataframe con las descripciones de las variables
tabla_descripciones <- data.frame(
  "Código DANE" = c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO"),
  "Descripción" = c(
    "Valor total de ventas o ingresos en los últimos 12 meses",
    "El establecimiento tiene página web",
    "Número de computadores de escritorio en uso",
    "Número de computadores portátiles en uso",
    "Mes de referencia del valor reportado",
    "Dispositivos PDA/DMC en uso en el establecimiento",
    "Acceso o uso del servicio de Internet",
    "Uso de Internet dentro del establecimiento",
    "Actividades en las que se usa Internet",
    "Formas de pago aceptadas",
    "Uso de Internet fuera del establecimiento",
    "Código de departamento del establecimiento"
  )
)

# Crear un dataframe separado con los datos reales
datos_microestablecimientos <- establecimientos[, c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO")]

# Mostrar la tabla
print(tabla_descripciones)

```
# Justificacion de Variables

Hemos seleccionado estas 12 variables porque consideramos que nos ofrecen una visión integral del desempeño de los microestablecimientos en Colombia.
A continuación, explicamos cada una y su relevancia en el análisis.

**P1010 (Ventas o ingresos en los últimos 12 meses):** Es clave para medir el desempeño financiero de los establecimientos.

**P2532 (Página web):** Evaluamos la adopción tecnológica, importante para la visibilidad y competitividad.

**P1087 (Computadores de escritorio):** Reflejan el nivel tecnológico disponible.

**P1088 (Computadores portátiles):** Reflejan el nivel tecnológico disponible.

**P1057 (Mes de referencia):** Nos ayuda a contextualizar los datos financieros.

**P1092 (Dispositivos PDA/DMC):** Mide el uso de dispositivos tecnológicos avanzados.

**P2524 (Acceso a Internet):** Fundamental para analizar la modernización del negocio.

**P1093 (Uso de Internet dentro del establecimiento):** Permiten evaluar la conectividad y productividad.

**P1094 (Uso fuera del establecimiento):** Permiten evaluar la conectividad y productividad.

**P1006 (Uso de Internet en actividades clave):** Nos permite conocer cómo la tecnología se integra en las operaciones diarias.

**P1764 (Formas de pago):** Es crucial para analizar la capacidad del establecimiento de gestionar transacciones modernas.

**CDGO_DPRTMNTO (Código de departamento):** Ayuda a contextualizar geográficamente los establecimientos, permitiendo análisis regionales (por ejemplo, el costo de la energía eléctrica).


# Análisis descriptivo.
```{r echo=FALSE,message=FALSE, warning=FALSE}
# Convertir la columna P1010 a numérica si no está ya en ese formato
datos_microestablecimientos$P1010 <- as.numeric(datos_microestablecimientos$P1010)

# Verificar si hay valores NA después de la conversión
cat("Valores NA en P1010:", sum(is.na(datos_microestablecimientos$P1010)), "\n")

# Calcular la media, mediana, desviación estándar y varianza
media <- mean(datos_microestablecimientos$P1010, na.rm = TRUE)
mediana <- median(datos_microestablecimientos$P1010, na.rm = TRUE)
desviacion_estandar <- sd(datos_microestablecimientos$P1010, na.rm = TRUE)
varianza <- var(datos_microestablecimientos$P1010, na.rm = TRUE)

# Mostrar los resultados
cat("Media:", media, "\n")
cat("Mediana:", mediana, "\n")
cat("Desviación Estándar:", desviacion_estandar, "\n")
cat("Varianza:", varianza, "\n")

# Resumen de la variable P1010
resumen <- summary(datos_microestablecimientos$P1010)
print(resumen)

# Agrupar por 'P2532' (página web) y calcular la media de 'P1010'
grpie <- variables_seleccionadas %>%
  group_by(P2532) %>%
  summarise(media_P1010 = mean(P1010, na.rm=TRUE)) 

# Extraer etiquetas y tamaños
labels <- grpie$P2532
sizes  <- grpie$media_P1010

# Crear una paleta de colores
library(RColorBrewer)
color <- brewer.pal(length(sizes), "Set2")

# Crear etiquetas para el gráfico
pie_labels <- paste0(round(100 * sizes/sum(sizes), 2), "%")
pie(sizes, labels = pie_labels, col = color)

# Añadir leyenda
legend("topright", legend = c("Con Página Web", "Sin Página Web"),
       fill =  c("#66C2A5", "#FC8D62"))

# Análisis en el texto
cat("Ventas medias en porcentajes relevantes a la variable *cuenta o no con página web* en la empresa. 
Este pie muestra que aquellas empresas que tienen página web tienen ventas medias mayores. Esto no implica que el internet sea de por sí la variable que impacte el desempeño de estas empresas. Es posible que estas empresas tengan más recursos para poder invertir en tecnología.")

# Agrupar por 'P2524' (uso de internet) y calcular la media de 'P1010'
grpie <- variables_seleccionadas %>%
  group_by(P2524) %>%
  summarise(media_P1010 = mean(P1010, na.rm=TRUE)) 

# Extraer etiquetas y tamaños
labels <- grpie$P2524
sizes  <- grpie$media_P1010

# Crear una paleta de colores
library(RColorBrewer)
color <- brewer.pal(length(sizes), "Set2")

# Crear etiquetas para el gráfico
pie_labels <- paste0(round(100 * sizes/sum(sizes), 2), "%")
pie(sizes, labels = pie_labels, col = color)

# Añadir leyenda
legend("topright", legend = c("Internet Sí", "Internet No"),
       fill =  c("#66C2A5", "#FC8D62"))

# Análisis en el texto
cat("Ventas medias en porcentajes relevantes a la variable *tiene o no internet* en la empresa. 
Este pie muestra que aquellas empresas que cuentan con internet tienen mayores ventas promedio que las que no. Comparada esta gráfica con la anterior, vemos que el tener internet en la empresa, con respecto a si tienen o no página web, 
presenta un incremento de más de un punto porcentual, i.e. de 70.16% a 71.78%. Esto indica que efectivamente puede ser más importante 
tener internet que contar con página web. Sin embargo, hay una gran diferencia con aquellas empresas que no tienen ni internet ni página web.")

# Gráfico de barras para la variable P2524 (Presencia de Internet en los Establecimientos)
ggplot(variables_seleccionadas, aes(x = factor(P2524))) +
  geom_bar(fill = "orange", color = "black") +
  labs(title = "Presencia de Internet en los Establecimientos",
       x = "Internet",
       y = "Frecuencia") +
  scale_x_discrete(labels = c("1" = "Sí", "2" = "No"))

#Analisis en el texto
cat("Podemos observar que las empresa que no tienen internet son muchas más comparadas con aquellas que si tiene.  Aún así, de acuerdo a las figuras de torta anteriores son empresas con  un mayor volumen de ventas comparativamente hablando.")

# Filtrar datos válidos para la variable P2532 (Página web)
datos_validos_pagina_web <- datos_microestablecimientos$P2532[!is.na(datos_microestablecimientos$P2532) & is.finite(datos_microestablecimientos$P2532)]

# Gráfico de barras para la variable página web (P2532)
if (length(datos_validos_pagina_web) > 0) {
  barplot(table(datos_validos_pagina_web), 
          main = "Proporción de Establecimientos con Página Web (P2532)", 
          col = c("red", "green"), 
          names.arg = c("No", "Sí"))
} else {
  cat("No hay datos válidos para la variable P2532")
}

# Filtrar datos válidos para la variable P1764 (Formas de pago)
datos_validos_formas_pago <- datos_microestablecimientos$P1764[!is.na(datos_microestablecimientos$P1764) & is.finite(datos_microestablecimientos$P1764)]

# Histograma para el número de computadores de escritorio (P1087)
hist(datos_microestablecimientos$P1087, 
     main = "Distribución del Número de Computadores de Escritorio (P1087)", 
     xlab = "Computadores de Escritorio", 
     col = "lightblue", 
     breaks = 20)

# Histograma para el número de computadores portátiles (P1088)
hist(datos_microestablecimientos$P1088, 
     main = "Distribución del Número de Computadores Portátiles (P1088)", 
     xlab = "Computadores Portátiles", 
     col = "lightcoral", 
     breaks = 20)

# Convertir P2532 a factor con etiquetas "No" y "Sí"
variables_seleccionadas$P2532 <- factor(variables_seleccionadas$P2532, levels = c(0, 1), labels = c("No", "Sí"))

```

# Distribución del total de ventas o ingresos.

```{r echo=FALSE, message=FALSE, warning=FALSE}

```

# Estrategías.

# Limitaciones u oportunidades.

# Referencias.
