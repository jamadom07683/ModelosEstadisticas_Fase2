---
title: "Encuesta microestablecimientos 2016"
author: 
- David Moreno, Santiago Amado, Yodid Cardenas

 - Maestría en Ciencia de Datos

 - Modelos Estadísticos Aplicados
date: ""
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
  word_document:
    toc: yes
---



```{r echo=FALSE}
# URL actualizada del archivo en GitHub
url <- "https://raw.githubusercontent.com/jamadom07683/ModelosEstadisticas_Fase2/refs/heads/main/Microestablecimientos_2016.csv"

```


```{r echo=FALSE}
# Leer el archivo CSV desde la URL
establecimientos <- read.csv(url,sep = ";")
```


# Contextualización. 
**Contextualización de datos:**

El conjunto de datos de microestablecimientos 2016 se recopila con el objetivo de analizar las características y el desempeño económico de las pequeñas unidades productivas en el país. La base de datos incluye una amplia gama de información que abarca aspectos financieros, laborales y tecnológicos de los microestablecimientos, permitiendo así un análisis detallado de su estructura y comportamiento en el mercado. Las fuentes de información provienen principalmente de encuestas realizadas a los microempresarios y registros administrativos, cubriendo diferentes sectores económicos a nivel nacional. La base de datos cuenta con más de 100 variables que representan desde ingresos anuales hasta el uso de tecnología, como la existencia de una página web.

En términos de cobertura, la base de datos abarca microestablecimientos de diferentes regiones del país, permitiendo así un análisis geográfico y sectorial de los mismos. Las unidades de análisis son los microestablecimientos, definidos como pequeñas empresas que tienen un número limitado de empleados y recursos financieros, pero que representan un sector importante de la economía local. El muestreo utilizado es probabilístico, lo que garantiza que los resultados sean representativos de la población de microestablecimientos a nivel nacional. La información recolectada incluye variables cuantitativas, como los ingresos y gastos, y cualitativas, como el tipo de propiedad o el sector de actividad.

El objetivo del análisis estadístico que presentamos en este informe es identificar patrones de comportamiento entre los microestablecimientos en términos de ingresos, inversión en tecnología y capacidad laboral, con el fin de ofrecer recomendaciones sobre cómo estos negocios pueden mejorar su productividad y sostenibilidad. También se busca entender el impacto de la formalización y la adopción de tecnología en el desempeño de los microestablecimientos, lo que puede ayudar a orientar políticas públicas que fomenten el crecimiento de este sector en la economía.


# Elección de variables.
```{r echo=FALSE}
# Seleccionar las columnas relevantes incluyendo las nuevas sugerencias
variables_seleccionadas <- establecimientos[, c("P1010", "P2532", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P3014", "P3019", "P1094", "P3017_A")]

# Ver las primeras filas para verificar la selección
head(variables_seleccionadas)

```
#Justificacion de Variables

Hemos seleccionado 12 variables clave para realizar el análisis de los microestablecimientos, ya que consideramos que nos ofrecen una visión completa de su desempeño económico, tecnológico y organizativo. A continuación, describimos brevemente cada una de ellas y explicamos por qué las hemos elegido.

Ventas o ingresos en los últimos 12 meses (P1010): Esta variable es fundamental para medir el desempeño financiero de los microestablecimientos, ya que refleja el valor total de las ventas o ingresos que han tenido en el último año.

Existencia de página web (P2532): Nos permite evaluar el nivel de adopción tecnológica en los establecimientos. Consideramos que contar con una página web puede ser un factor clave en la modernización y visibilidad del negocio.

Número de empleados (P1057): Esta variable es importante porque nos indica la capacidad laboral del establecimiento, lo que puede estar relacionado con su tamaño y capacidad operativa.

Registro del establecimiento (P1092): El grado de formalización es un aspecto crítico para entender si los microestablecimientos operan dentro del marco legal, lo cual influye en su acceso a financiamiento y otros beneficios.

Sector económico (P2524): Nos ayuda a clasificar los establecimientos dentro de un sector económico específico, permitiendo hacer análisis más detallados por industria y comprender mejor el contexto en el que operan.

Estructura organizativa (P1093): Esta variable nos da información sobre la forma legal o estructura del negocio (si es unipersonal, cooperativa, sociedad, etc.), lo que influye directamente en su capacidad de crecimiento y acceso a recursos.

Inversión en activos (P1006): Consideramos que es relevante saber cuánto invierten los establecimientos en infraestructura y tecnología, ya que esto puede estar vinculado a su capacidad de expandirse y mejorar sus procesos productivos.

Facturación u otros ingresos (P1764): Además de las ventas directas, es útil conocer si el establecimiento genera otros tipos de ingresos, lo que puede proporcionar una imagen más completa de sus finanzas.

Evolución del establecimiento (P3014): Esta variable nos permite ver cómo ha cambiado el establecimiento en los últimos años, lo que es crucial para identificar tendencias de crecimiento o declive.

Características del mercado o clientes (P3019): Saber a qué tipo de clientes o mercados están orientados los microestablecimientos nos ofrece información valiosa sobre sus estrategias comerciales y su posicionamiento en el mercado.

Gastos operativos (P1094): Este dato es esencial para entender cómo manejan los microestablecimientos sus costos diarios, lo cual tiene un impacto directo en su rentabilidad y sostenibilidad.

Actividad económica específica (P3017_A): Nos permite clasificar los establecimientos según su actividad principal, lo que facilita realizar un análisis más profundo por sectores y entender mejor las particularidades de cada uno.

# Análisis descriptivo.
```{r echo=FALSE}
```
# Distribución del total de ventas o ingresos.
```{r echo=FALSE}
# Definir la función para graficar la distribución
graficar_distribucion <- function(datos, titulo) {
  # Crear el histograma
  hist(datos$P1010, prob = TRUE, main = titulo, xlab = "Ventas o ingresos", col = "lightblue", breaks = 30)
  
  # Añadir la curva de densidad
  lines(density(datos$P1010, na.rm = TRUE), col = "red", lwd = 2)
  
  # Añadir la curva de distribución normal
  media <- mean(datos$P1010, na.rm = TRUE)
  sd <- sd(datos$P1010, na.rm = TRUE)
  curve(dnorm(x, mean = media, sd = sd), add = TRUE, col = "blue", lwd = 2)
}

# Filtrar los datos para ventas menores a 100 millones
datos_filtrados <- variables_seleccionadas[variables_seleccionadas$P1010 < 100000000, ]

# Verificar si los datos filtrados tienen alguna fila
if (nrow(datos_filtrados) > 0) {
  
  # Filtrar los que NO tienen página web
  sin_web <- datos_filtrados[datos_filtrados$P2532 == 0, ]
  
  # Filtrar los que SÍ tienen página web
  con_web <- datos_filtrados[datos_filtrados$P2532 == 1, ]
  
  # Verificar si el subconjunto sin_web tiene datos y no está vacío
  if (nrow(sin_web) > 0 && sum(!is.na(sin_web$P1010)) > 0) {
    graficar_distribucion(sin_web, "Distribución de Ventas (Sin Página Web)")
  } else {
    print("No hay datos suficientes para los establecimientos sin página web.")
  }
  
  # Verificar si el subconjunto con_web tiene datos y no está vacío
  if (nrow(con_web) > 0 && sum(!is.na(con_web$P1010)) > 0) {
    graficar_distribucion(con_web, "Distribución de Ventas (Con Página Web)")
  } else {
    print("No hay datos suficientes para los establecimientos con página web.")
  }
  
} else {
  print("No hay datos suficientes después del filtrado.")
}

```

# Estimaciones.
```{r echo=FALSE}
print("Valor total de ventas o ingresos promedio en los últimos 12 meses")

# Remover los valores NA para la columna P1010
ventas <- na.omit(variables_seleccionadas$P1010)

# Cálculo del promedio y desviación estándar
promedio_ventas <- mean(ventas)
desviacion_ventas <- sd(ventas)

# Tamaño de la muestra
n_ventas <- length(ventas)

# Error estándar del promedio
error_estandar_ventas <- desviacion_ventas / sqrt(n_ventas)
error_margen_ventas <- qnorm(0.975) * error_estandar_ventas

# Intervalo de confianza
limite_inferior_ventas <- promedio_ventas - error_margen_ventas
limite_superior_ventas <- promedio_ventas + error_margen_ventas

# Mostrar el intervalo de confianza
cat("Intervalo de confianza para el promedio de ventas (95%): [", limite_inferior_ventas, ", ", limite_superior_ventas, "]\n")

print("Proporción de microestablecimientos que cuentan con página web")

# Remover valores NA para la columna P2532
pagina_web <- na.omit(variables_seleccionadas$P2532)

# Cálculo de la proporción de establecimientos con página web
proporcion_web <- mean(pagina_web)

# Tamaño de la muestra
n_web <- length(pagina_web)

# Error estándar de la proporción
error_estandar_web <- sqrt(proporcion_web * (1 - proporcion_web) / n_web)

# Intervalo de confianza del 95% para la proporción
error_margen_web <- qnorm(0.975) * error_estandar_web

# Intervalo de confianza
limite_inferior_web <- proporcion_web - error_margen_web
limite_superior_web <- proporcion_web + error_margen_web

# Mostrar el intervalo de confianza
cat("Intervalo de confianza para la proporción de establecimientos con página web (95%): [", limite_inferior_web, ", ", limite_superior_web, "]\n")

print("Estimación del número promedio de empleados")

# Remover valores NA para la columna P1057
empleados <- na.omit(variables_seleccionadas$P1057)

# Cálculo del promedio y desviación estándar
promedio_empleados <- mean(empleados)
desviacion_empleados <- sd(empleados)

# Tamaño de la muestra
n_empleados <- length(empleados)

# Error estándar del promedio
error_estandar_empleados <- desviacion_empleados / sqrt(n_empleados)
error_margen_empleados <- qnorm(0.975) * error_estandar_empleados

# Intervalo de confianza
limite_inferior_empleados <- promedio_empleados - error_margen_empleados
limite_superior_empleados <- promedio_empleados + error_margen_empleados

# Mostrar el intervalo de confianza
cat("Intervalo de confianza para el promedio de empleados (95%): [", limite_inferior_empleados, ", ", limite_superior_empleados, "]\n")

print("Estimación del gasto operativo promedio")

# Remover valores NA para la columna P1094
gastos_operativos <- na.omit(variables_seleccionadas$P1094)

# Cálculo del promedio y desviación estándar
promedio_gastos <- mean(gastos_operativos)
desviacion_gastos <- sd(gastos_operativos)

# Tamaño de la muestra
n_gastos <- length(gastos_operativos)

# Error estándar del promedio
error_estandar_gastos <- desviacion_gastos / sqrt(n_gastos)
error_margen_gastos <- qnorm(0.975) * error_estandar_gastos

# Intervalo de confianza
limite_inferior_gastos <- promedio_gastos - error_margen_gastos
limite_superior_gastos <- promedio_gastos + error_margen_gastos

# Mostrar el intervalo de confianza
cat("Intervalo de confianza para el promedio de gastos operativos (95%): [", limite_inferior_gastos, ", ", limite_superior_gastos, "]\n")

```

# Estrategías.

# Limitaciones u oportunidades.

# Referencias.
