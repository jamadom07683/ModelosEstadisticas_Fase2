---
title: "Encuesta microestablecimientos 2016"
author: 
- David Moreno, Santiago Amado, Yodid Cardenas

- Maestría en Ciencia de Datos

- Modelos Estadísticos Aplicados
date: ""
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
  word_document:
    toc: yes
---



```{r echo=FALSE, message=FALSE, warning=FALSE}

# Instalar ggplot2 si no está instalado
if(!require(ggplot2)) install.packages("ggplot2", dependencies=TRUE)
# Instalar y cargar RColorBrewer si no está instalado
if (!require(RColorBrewer)) {
  install.packages("RColorBrewer")
}
library(RColorBrewer)

# Instalar y cargar el paquete dplyr si no está instalado
if (!require(dplyr)) {
  install.packages("dplyr")
}
library(dplyr)

# URL actualizada del archivo en GitHub
url <- "https://raw.githubusercontent.com/jamadom07683/ModelosEstadisticas_Fase2/refs/heads/main/Microestablecimientos_2016.csv"

```


```{r echo=FALSE}
# Leer el archivo CSV desde la URL
establecimientos <- read.csv(url,sep = ";")
```


# Contextualización. 
**Contextualización de datos:**

El conjunto de datos de microestablecimientos 2016 se recopila con el objetivo de analizar las características y el desempeño económico de las pequeñas unidades productivas en el país. La base de datos incluye una amplia gama de información que abarca aspectos financieros, laborales y tecnológicos de los microestablecimientos, permitiendo así un análisis detallado de su estructura y comportamiento en el mercado. Las fuentes de información provienen principalmente de encuestas realizadas a los microempresarios y registros administrativos, cubriendo diferentes sectores económicos a nivel nacional. La base de datos cuenta con más de 100 variables que representan desde ingresos anuales hasta el uso de tecnología, como la existencia de una página web.

En términos de cobertura, la base de datos abarca microestablecimientos de diferentes regiones del país, permitiendo así un análisis geográfico y sectorial de los mismos. Las unidades de análisis son los microestablecimientos, definidos como pequeñas empresas que tienen un número limitado de empleados y recursos financieros, pero que representan un sector importante de la economía local. El muestreo utilizado es probabilístico, lo que garantiza que los resultados sean representativos de la población de microestablecimientos a nivel nacional. La información recolectada incluye variables cuantitativas, como los ingresos y gastos, y cualitativas, como el tipo de propiedad o el sector de actividad.

El objetivo del análisis estadístico que presentamos en este informe es identificar patrones de comportamiento entre los microestablecimientos en términos de ingresos, inversión en tecnología y capacidad laboral, con el fin de ofrecer recomendaciones sobre cómo estos negocios pueden mejorar su productividad y sostenibilidad. También se busca entender el impacto de la formalización y la adopción de tecnología en el desempeño de los microestablecimientos, lo que puede ayudar a orientar políticas públicas que fomenten el crecimiento de este sector en la economía.


# Elección de variables.
```{r echo=FALSE}
# Seleccionar las columnas relevantes, reemplazando P3019 por CDGO_DPRTMNTO
variables_seleccionadas <- establecimientos[, c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO")]

# Crear un dataframe con las descripciones de las variables
tabla_descripciones <- data.frame(
  "Código DANE" = c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO"),
  "Descripción" = c(
    "Valor total de ventas o ingresos en los últimos 12 meses",
    "El establecimiento tiene página web",
    "Número de computadores de escritorio en uso",
    "Número de computadores portátiles en uso",
    "Mes de referencia del valor reportado",
    "Dispositivos PDA/DMC en uso en el establecimiento",
    "Acceso o uso del servicio de Internet",
    "Uso de Internet dentro del establecimiento",
    "Actividades en las que se usa Internet",
    "Formas de pago aceptadas",
    "Uso de Internet fuera del establecimiento",
    "Código de departamento del establecimiento"
  )
)

# Crear un dataframe separado con los datos reales
datos_microestablecimientos <- establecimientos[, c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO")]

# Mostrar la tabla
print(tabla_descripciones)

```
# Justificacion de Variables

Hemos seleccionado estas 12 variables porque consideramos que nos ofrecen una visión integral del desempeño de los microestablecimientos en Colombia.
A continuación, explicamos cada una y su relevancia en el análisis.

**P1010 (Ventas o ingresos en los últimos 12 meses):** Es clave para medir el desempeño financiero de los establecimientos.

**P2532 (Página web):** Evaluamos la adopción tecnológica, importante para la visibilidad y competitividad.

**P1087 (Computadores de escritorio):** Reflejan el nivel tecnológico disponible.

**P1088 (Computadores portátiles):** Reflejan el nivel tecnológico disponible.

**P1057 (Mes de referencia):** Nos ayuda a contextualizar los datos financieros.

**P1092 (Dispositivos PDA/DMC):** Mide el uso de dispositivos tecnológicos avanzados.

**P2524 (Acceso a Internet):** Fundamental para analizar la modernización del negocio.

**P1093 (Uso de Internet dentro del establecimiento):** Permiten evaluar la conectividad y productividad.

**P1094 (Uso fuera del establecimiento):** Permiten evaluar la conectividad y productividad.

**P1006 (Uso de Internet en actividades clave):** Nos permite conocer cómo la tecnología se integra en las operaciones diarias.

**P1764 (Formas de pago):** Es crucial para analizar la capacidad del establecimiento de gestionar transacciones modernas.

**CDGO_DPRTMNTO (Código de departamento):** Ayuda a contextualizar geográficamente los establecimientos, permitiendo análisis regionales (por ejemplo, el costo de la energía eléctrica).


# Análisis descriptivo.
```{r echo=FALSE,message=FALSE, warning=FALSE}
# Convertir la columna P1010 a numérica si no está ya en ese formato
datos_microestablecimientos$P1010 <- as.numeric(datos_microestablecimientos$P1010)

# Verificar si hay valores NA después de la conversión
cat("Valores NA en P1010:", sum(is.na(datos_microestablecimientos$P1010)), "\n")

# Calcular la media, mediana, desviación estándar y varianza
media <- mean(datos_microestablecimientos$P1010, na.rm = TRUE)
mediana <- median(datos_microestablecimientos$P1010, na.rm = TRUE)
desviacion_estandar <- sd(datos_microestablecimientos$P1010, na.rm = TRUE)
varianza <- var(datos_microestablecimientos$P1010, na.rm = TRUE)

# Mostrar los resultados
cat("Media:", media, "\n")
cat("Mediana:", mediana, "\n")
cat("Desviación Estándar:", desviacion_estandar, "\n")
cat("Varianza:", varianza, "\n")

# Resumen de la variable P1010
resumen <- summary(datos_microestablecimientos$P1010)
print(resumen)

# Agrupar por 'P2532' (página web) y calcular la media de 'P1010'
grpie <- variables_seleccionadas %>%
  group_by(P2532) %>%
  summarise(media_P1010 = mean(P1010, na.rm=TRUE)) 

# Extraer etiquetas y tamaños
labels <- grpie$P2532
sizes  <- grpie$media_P1010

# Crear una paleta de colores
library(RColorBrewer)
color <- brewer.pal(length(sizes), "Set2")

# Crear etiquetas para el gráfico
pie_labels <- paste0(round(100 * sizes/sum(sizes), 2), "%")
pie(sizes, labels = pie_labels, col = color)

# Añadir leyenda
legend("topright", legend = c("Con Página Web", "Sin Página Web"),
       fill =  c("#66C2A5", "#FC8D62"))

# Análisis en el texto
cat("Ventas medias en porcentajes relevantes a la variable *cuenta o no con página web* en la empresa. 
Este pie muestra que aquellas empresas que tienen página web tienen ventas medias mayores. Esto no implica que el internet sea de por sí la variable que impacte el desempeño de estas empresas. Es posible que estas empresas tengan más recursos para poder invertir en tecnología.")

# Agrupar por 'P2524' (uso de internet) y calcular la media de 'P1010'
grpie <- variables_seleccionadas %>%
  group_by(P2524) %>%
  summarise(media_P1010 = mean(P1010, na.rm=TRUE)) 

# Extraer etiquetas y tamaños
labels <- grpie$P2524
sizes  <- grpie$media_P1010

# Crear una paleta de colores
library(RColorBrewer)
color <- brewer.pal(length(sizes), "Set2")

# Crear etiquetas para el gráfico
pie_labels <- paste0(round(100 * sizes/sum(sizes), 2), "%")
pie(sizes, labels = pie_labels, col = color)

# Añadir leyenda
legend("topright", legend = c("Internet Sí", "Internet No"),
       fill =  c("#66C2A5", "#FC8D62"))

# Análisis en el texto
cat("Ventas medias en porcentajes relevantes a la variable *tiene o no internet* en la empresa. 
Este pie muestra que aquellas empresas que cuentan con internet tienen mayores ventas promedio que las que no. Comparada esta gráfica con la anterior, vemos que el tener internet en la empresa, con respecto a si tienen o no página web, 
presenta un incremento de más de un punto porcentual, i.e. de 70.16% a 71.78%. Esto indica que efectivamente puede ser más importante 
tener internet que contar con página web. Sin embargo, hay una gran diferencia con aquellas empresas que no tienen ni internet ni página web.")

# Gráfico de barras para la variable P2524 (Presencia de Internet en los Establecimientos)
ggplot(variables_seleccionadas, aes(x = factor(P2524))) +
  geom_bar(fill = "orange", color = "black") +
  labs(title = "Presencia de Internet en los Establecimientos",
       x = "Internet",
       y = "Frecuencia") +
  scale_x_discrete(labels = c("1" = "Sí", "2" = "No"))

#Analisis en el texto
cat("Podemos observar que las empresa que no tienen internet son muchas más comparadas con aquellas que si tiene.  Aún así, de acuerdo a las figuras de torta anteriores son empresas con  un mayor volumen de ventas comparativamente hablando.")

# Filtrar datos válidos para la variable P2532 (Página web)
datos_validos_pagina_web <- datos_microestablecimientos$P2532[!is.na(datos_microestablecimientos$P2532) & is.finite(datos_microestablecimientos$P2532)]

# Gráfico de barras para la variable página web (P2532)
if (length(datos_validos_pagina_web) > 0) {
  barplot(table(datos_validos_pagina_web), 
          main = "Proporción de Establecimientos con Página Web (P2532)", 
          col = c("red", "green"), 
          names.arg = c("No", "Sí"))
} else {
  cat("No hay datos válidos para la variable P2532")
}

# Filtrar datos válidos para la variable P1764 (Formas de pago)
datos_validos_formas_pago <- datos_microestablecimientos$P1764[!is.na(datos_microestablecimientos$P1764) & is.finite(datos_microestablecimientos$P1764)]

# Histograma para el número de computadores de escritorio (P1087)
hist(datos_microestablecimientos$P1087, 
     main = "Distribución del Número de Computadores de Escritorio (P1087)", 
     xlab = "Computadores de Escritorio", 
     col = "lightblue", 
     breaks = 20)

# Histograma para el número de computadores portátiles (P1088)
hist(datos_microestablecimientos$P1088, 
     main = "Distribución del Número de Computadores Portátiles (P1088)", 
     xlab = "Computadores Portátiles", 
     col = "lightcoral", 
     breaks = 20)

# Convertir P2532 a factor con etiquetas "No" y "Sí"
variables_seleccionadas$P2532 <- factor(variables_seleccionadas$P2532, levels = c(0, 1), labels = c("No", "Sí"))

```

# Distribución del total de ventas o ingresos.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Filtrar los datos para los establecimientos que no tienen página web (P2532 == 2) y ventas menores a $100,000,000
sin_pagina_web <- datos_microestablecimientos %>%
  filter(P1010 < 100000000 & P2532 == 2 & !is.na(P1010))

# Filtrar los datos para los establecimientos que sí tienen página web (P2532 == 1) y ventas menores a $100,000,000
con_pagina_web <- datos_microestablecimientos %>%
  filter(P1010 < 100000000 & P2532 == 1 & !is.na(P1010))

# Gráfico para los establecimientos sin página web
ggplot(sin_pagina_web, aes(x = P1010)) +
  geom_histogram(aes(y = ..density..), bins = 30, fill = "skyblue", color = "black") +
  geom_density(color = "red", size = 1.5) +
  stat_function(fun = dnorm, args = list(mean = mean(sin_pagina_web$P1010, na.rm = TRUE), 
                                         sd = sd(sin_pagina_web$P1010, na.rm = TRUE)), color = "blue", size = 1) +
  labs(title = "Distribución del Total de Ventas (P1010) - Sin Página Web", 
       x = "Ventas (P1010)", 
       y = "Densidad") +
  theme_minimal()

# Gráfico para los establecimientos con página web
ggplot(con_pagina_web, aes(x = P1010)) +
  geom_histogram(aes(y = ..density..), bins = 30, fill = "skyblue", color = "black") +
  geom_density(color = "red", size = 1.5) +
  stat_function(fun = dnorm, args = list(mean = mean(con_pagina_web$P1010, na.rm = TRUE), 
                                         sd = sd(con_pagina_web$P1010, na.rm = TRUE)), color = "blue", size = 1) +
  labs(title = "Distribución del Total de Ventas (P1010) - Con Página Web", 
       x = "Ventas (P1010)", 
       y = "Densidad") +
  theme_minimal()

# Calcular la media y desviación estándar de todos los establecimientos
media_ventas_total <- mean(datos_microestablecimientos$P1010, na.rm = TRUE)
sd_ventas_total <- sd(datos_microestablecimientos$P1010, na.rm = TRUE)

# Calcular la probabilidad de que las ventas superen los $100,000,000
probabilidad_mas_100m <- 1 - pnorm(100000000, mean = media_ventas_total, sd = sd_ventas_total)

# Imprimir la probabilidad
cat("La probabilidad de que un microestablecimiento registre ventas superiores a $100,000,000 es:", probabilidad_mas_100m, "\n")

```

# Estrategias

Desarrollar una estrategia basada en el análisis de las variables seleccionadas nos permite enfocarnos en varios aspectos clave que ayudarán a mejorar el desempeño de los microestablecimientos en Colombia, como los siguientes:

Estrategia 1: Mejorar la Adopción Tecnológica
Fomentar la creación y mantenimiento de páginas web para los establecimientos que aún no tienen una. Esto puede aumentar la visibilidad y atraer a más clientes. También se puede promover el uso de Internet tanto dentro como fuera del establecimiento para mejorar la eficiencia operativa y la conectividad.

Estrategia 2: Optimización de Recursos Tecnológicos
Evaluar la necesidad de actualizar o incrementar el número de computadores para mejorar la productividad. Incentivar el uso de dispositivos avanzados para tareas específicas que puedan beneficiarse al tener nuevas tecnologías.

Estrategia 3: Análisis Financiero y de Ventas
Realizar un seguimiento constante de las ventas para identificar tendencias y áreas de mejora. Implementar estrategias de marketing y ventas basadas en estos datos. Utilizar esta información para ajustar estrategias de ventas y marketing según las variaciones estacionales o mensuales, considerando los efectos en proveedores y personal, para tomar decisiones basadas en los datos.

Estrategia 4: Formas de Pago
Diversificar las formas de pago aceptadas para facilitar las transacciones y atraer a más clientes. Incluir opciones modernas como pagos móviles y billeteras digitales.

Estrategia 5: Análisis Regional
Realizar análisis regionales para identificar las necesidades específicas de cada área y adaptar las estrategias en consecuencia. Por ejemplo, en regiones con altos costos de energía, se pueden buscar alternativas más eficientes o sostenibles.

Estrategia 6: Capacitación y Educación
Es crucial mantenerse en constante capacitación dentro del nicho correspondiente para ofrecer mejores servicios y productos, alineados con la fuente de comercio del microestablecimiento. La capacitación debe incluir tanto el enfoque específico del establecimiento como conocimientos financieros y de optimización de recursos.

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Calcular el intervalo de confianza para el valor total de ventas o ingresos (P1010)
cat("\n## Calcular el intervalo de confianza para el valor total de ventas o ingresos (P1010)\n")
ventas_validas <- datos_microestablecimientos %>% filter(!is.na(P1010))
media_ventas <- mean(ventas_validas$P1010)
sd_ventas <- sd(ventas_validas$P1010)
n_ventas <- nrow(ventas_validas)
error_estandar_ventas <- sd_ventas / sqrt(n_ventas)
z_score <- qnorm(0.975)
limite_inferior_ventas <- media_ventas - z_score * error_estandar_ventas
limite_superior_ventas <- media_ventas + z_score * error_estandar_ventas
cat("Intervalo de confianza al 95% para el valor total de ventas promedio:\n")
cat("Media:", media_ventas, "\n")
cat("IC:", limite_inferior_ventas, "-", limite_superior_ventas, "\n")

# Calcular el intervalo de confianza para la proporción de microestablecimientos con página web (P2532)
cat("\n## Calcular el intervalo de confianza para la proporción de microestablecimientos con página web (P2532)\n")
pagina_web_valida <- datos_microestablecimientos %>% filter(!is.na(P2532))
proporcion_pagina_web <- mean(pagina_web_valida$P2532)
n_pagina_web <- nrow(pagina_web_valida)
error_estandar_pagina_web <- sqrt(proporcion_pagina_web * (1 - proporcion_pagina_web) / n_pagina_web)
limite_inferior_pagina_web <- proporcion_pagina_web - z_score * error_estandar_pagina_web
limite_superior_pagina_web <- proporcion_pagina_web + z_score * error_estandar_pagina_web
cat("Intervalo de confianza al 95% para la proporción de establecimientos con página web:\n")
cat("Proporción:", proporcion_pagina_web, "\n")
cat("IC:", limite_inferior_pagina_web, "-", limite_superior_pagina_web, "\n")

# Estimación adicional 1: Proporción de microestablecimientos con acceso a Internet (P2524)
cat("\n## Estimación adicional 1: Proporción de microestablecimientos con acceso a Internet (P2524)\n")
internet_valido <- datos_microestablecimientos %>% filter(!is.na(P2524))
proporcion_internet <- mean(internet_valido$P2524)
n_internet <- nrow(internet_valido)
error_estandar_internet <- sqrt(proporcion_internet * (1 - proporcion_internet) / n_internet)
limite_inferior_internet <- proporcion_internet - z_score * error_estandar_internet
limite_superior_internet <- proporcion_internet + z_score * error_estandar_internet
cat("Intervalo de confianza al 95% para la proporción de establecimientos con acceso a Internet:\n")
cat("Proporción:", proporcion_internet, "\n")
cat("IC:", limite_inferior_internet, "-", limite_superior_internet, "\n")

# Estimación adicional 2: Promedio de computadores portátiles en uso (P1088)
cat("\n## Estimación adicional 2: Promedio de computadores portátiles en uso (P1088)\n")
portatiles_validos <- datos_microestablecimientos %>% filter(!is.na(P1088))
media_portatiles <- mean(portatiles_validos$P1088)
sd_portatiles <- sd(portatiles_validos$P1088)
n_portatiles <- nrow(portatiles_validos)
error_estandar_portatiles <- sd_portatiles / sqrt(n_portatiles)
limite_inferior_portatiles <- media_portatiles - z_score * error_estandar_portatiles
limite_superior_portatiles <- media_portatiles + z_score * error_estandar_portatiles
cat("Intervalo de confianza al 95% para el número promedio de computadores portátiles:\n")
cat("Media:", media_portatiles, "\n")
cat("IC:", limite_inferior_portatiles, "-", limite_superior_portatiles, "\n")
```
# Limitaciones u oportunidades.
```{r echo=FALSE, message=FALSE, warning=FALSE}

# Limitación 1: Falta de variables actualizadas
cat("Limitación 2: Falta de variables actualizadas sobre tecnología\n")

# Descripción:
cat("Una limitación del análisis es la falta de información más reciente sobre el uso de tecnologías modernas, como comercio electrónico o redes sociales, que podrían ser relevantes para el desempeño de los microestablecimientos.\n")

# Ejemplo: Verificar la falta de variables relacionadas con tecnologías modernas
cat("Las variables clave como 'Acceso a Internet (P2524)' no capturan el uso de tecnologías recientes como el comercio electrónico o redes sociales, lo que podría limitar el análisis.\n")

# Mostrar la distribución actual de acceso a Internet como ejemplo de la falta de variables adicionales
barplot(table(datos_microestablecimientos$P2524), 
        main = "Distribución de Acceso a Internet (P2524)", 
        col = c("red", "green"), 
        names.arg = c("No", "Sí"))

# Limitacion 2: 
cat("\nLimitación 2: Alcance de las variables analizadas\n")

# Descripción:
cat("El análisis se enfocó principalmente en unas pocas variables (ventas, presencia de página web, acceso a internet), lo que limitó el entendimiento global de los factores que pueden influir en el rendimiento de los microestablecimientos. Se podría realizar un análisis más profundo incluyendo variables relacionadas con el sector económico, tamaño de los establecimientos, y otras tecnologías utilizadas. Incluir más variables relevantes en futuros análisis o encuestas nos permitiría obtener conclusiones más robustas y detalladas.\n")

# Mostrar las variables incluidas actualmente en el análisis
cat("Variables analizadas:\n")
print(colnames(datos_microestablecimientos))

# Oportunidad: Enriquecimiento de datos con nuevas tecnologías
cat("\nOportunidad: Enriquecimiento del análisis con tecnologías emergentes\n")

cat("Una oportunidad sería incluir variables relacionadas con la adopción de tecnologías emergentes, como el uso de inteligencia artificial, automatización y herramientas de comercio electrónico. 
Esto ayudaría a entender mejor cómo la modernización tecnológica impacta en los microestablecimientos y qué tecnologías tienen un mayor retorno de inversión.\n")

```

# Referencias.
Los datos utilizados para este análisis fueron obtenidos de la base de datos de microestablecimientos del DANE (2016). 
Más información puede ser consultada en: https://microdatos.dane.gov.co/index.php/catalog/560/data-dictionary/F10?file_name=Microestablecimientos_2016.\n")