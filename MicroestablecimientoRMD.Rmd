---
title: "Encuesta microestablecimientos 2016"
author: 
- David Moreno, Santiago Amado, Yodid Cardenas

 - Maestría en Ciencia de Datos

 - Modelos Estadísticos Aplicados
date: ""
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
  word_document:
    toc: yes
---



```{r echo=FALSE}
# URL actualizada del archivo en GitHub
url <- "https://raw.githubusercontent.com/jamadom07683/ModelosEstadisticas_Fase2/refs/heads/main/Microestablecimientos_2016.csv"

```


```{r echo=FALSE}
# Leer el archivo CSV desde la URL
establecimientos <- read.csv(url,sep = ";")
```


# Contextualización. 
**Contextualización de datos:**

El conjunto de datos de microestablecimientos 2016 se recopila con el objetivo de analizar las características y el desempeño económico de las pequeñas unidades productivas en el país. La base de datos incluye una amplia gama de información que abarca aspectos financieros, laborales y tecnológicos de los microestablecimientos, permitiendo así un análisis detallado de su estructura y comportamiento en el mercado. Las fuentes de información provienen principalmente de encuestas realizadas a los microempresarios y registros administrativos, cubriendo diferentes sectores económicos a nivel nacional. La base de datos cuenta con más de 100 variables que representan desde ingresos anuales hasta el uso de tecnología, como la existencia de una página web.

En términos de cobertura, la base de datos abarca microestablecimientos de diferentes regiones del país, permitiendo así un análisis geográfico y sectorial de los mismos. Las unidades de análisis son los microestablecimientos, definidos como pequeñas empresas que tienen un número limitado de empleados y recursos financieros, pero que representan un sector importante de la economía local. El muestreo utilizado es probabilístico, lo que garantiza que los resultados sean representativos de la población de microestablecimientos a nivel nacional. La información recolectada incluye variables cuantitativas, como los ingresos y gastos, y cualitativas, como el tipo de propiedad o el sector de actividad.

El objetivo del análisis estadístico que presentamos en este informe es identificar patrones de comportamiento entre los microestablecimientos en términos de ingresos, inversión en tecnología y capacidad laboral, con el fin de ofrecer recomendaciones sobre cómo estos negocios pueden mejorar su productividad y sostenibilidad. También se busca entender el impacto de la formalización y la adopción de tecnología en el desempeño de los microestablecimientos, lo que puede ayudar a orientar políticas públicas que fomenten el crecimiento de este sector en la economía.


# Elección de variables.
```{r echo=FALSE}
# Seleccionar las columnas relevantes, reemplazando P3019 por CDGO_DPRTMNTO
variables_seleccionadas <- establecimientos[, c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO")]

# Crear un dataframe con las descripciones de las variables
tabla_descripciones <- data.frame(
  "Código DANE" = c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO"),
  "Descripción" = c(
    "Valor total de ventas o ingresos en los últimos 12 meses",
    "El establecimiento tiene página web",
    "Número de computadores de escritorio en uso",
    "Número de computadores portátiles en uso",
    "Mes de referencia del valor reportado",
    "Dispositivos PDA/DMC en uso en el establecimiento",
    "Acceso o uso del servicio de Internet",
    "Uso de Internet dentro del establecimiento",
    "Actividades en las que se usa Internet",
    "Formas de pago aceptadas",
    "Uso de Internet fuera del establecimiento",
    "Código de departamento del establecimiento"
  )
)

# Crear un dataframe separado con los datos reales
datos_microestablecimientos <- establecimientos[, c("P1010", "P2532", "P1087", "P1088", "P1057", "P1092", "P2524", "P1093", "P1006", "P1764", "P1094", "CDGO_DPRTMNTO")]

# Mostrar la tabla
print(tabla_descripciones)

```
# Justificacion de Variables

Hemos seleccionado estas 12 variables porque consideramos que nos ofrecen una visión integral del desempeño de los microestablecimientos en Colombia.
A continuación, explicamos cada una y su relevancia en el análisis.

**P1010 (Ventas o ingresos en los últimos 12 meses):** Es clave para medir el desempeño financiero de los establecimientos.

**P2532 (Página web):** Evaluamos la adopción tecnológica, importante para la visibilidad y competitividad.

**P1087 (Computadores de escritorio):** Reflejan el nivel tecnológico disponible.

**P1088 (Computadores portátiles):** Reflejan el nivel tecnológico disponible.

**P1057 (Mes de referencia):** Nos ayuda a contextualizar los datos financieros.

**P1092 (Dispositivos PDA/DMC):** Mide el uso de dispositivos tecnológicos avanzados.

**P2524 (Acceso a Internet):** Fundamental para analizar la modernización del negocio.

**P1093 (Uso de Internet dentro del establecimiento):** Permiten evaluar la conectividad y productividad.

**P1094 (Uso fuera del establecimiento):** Permiten evaluar la conectividad y productividad.

**P1006 (Uso de Internet en actividades clave):** Nos permite conocer cómo la tecnología se integra en las operaciones diarias.

**P1764 (Formas de pago):** Es crucial para analizar la capacidad del establecimiento de gestionar transacciones modernas.

**CDGO_DPRTMNTO (Código de departamento):** Ayuda a contextualizar geográficamente los establecimientos, permitiendo análisis regionales (por ejemplo, el costo de la energía eléctrica).


# Análisis descriptivo.
```{r echo=FALSE}
# Convertir la columna P1010 a numérica si no está ya en ese formato
datos_microestablecimientos$P1010 <- as.numeric(datos_microestablecimientos$P1010)

# Verificar si hay valores NA después de la conversión
cat("Valores NA en P1010:", sum(is.na(datos_microestablecimientos$P1010)), "\n")

# Calcular la media, mediana, desviación estándar y varianza
media <- mean(datos_microestablecimientos$P1010, na.rm = TRUE)
mediana <- median(datos_microestablecimientos$P1010, na.rm = TRUE)
desviacion_estandar <- sd(datos_microestablecimientos$P1010, na.rm = TRUE)
varianza <- var(datos_microestablecimientos$P1010, na.rm = TRUE)

# Mostrar los resultados
cat("Media:", media, "\n")
cat("Mediana:", mediana, "\n")
cat("Desviación Estándar:", desviacion_estandar, "\n")
cat("Varianza:", varianza, "\n")

# Resumen de la variable P1010
resumen <- summary(datos_microestablecimientos$P1010)
print(resumen)

```
# Distribución del total de ventas o ingresos.
```{r echo=FALSE}
# Definir la función para graficar la distribución
graficar_distribucion <- function(datos, titulo) {
  # Crear el histograma
  hist(datos$P1010, prob = TRUE, main = titulo, xlab = "Ventas o ingresos", col = "lightblue", breaks = 30)
  
  # Añadir la curva de densidad
  lines(density(datos$P1010, na.rm = TRUE), col = "red", lwd = 2)
  
  # Añadir la curva de distribución normal
  media <- mean(datos$P1010, na.rm = TRUE)
  sd <- sd(datos$P1010, na.rm = TRUE)
  curve(dnorm(x, mean = media, sd = sd), add = TRUE, col = "blue", lwd = 2)
}

# Filtrar los datos para ventas menores a 100 millones
datos_filtrados <- variables_seleccionadas[variables_seleccionadas$P1010 < 100000000, ]

# Verificar si los datos filtrados tienen alguna fila
if (nrow(datos_filtrados) > 0) {
  
  # Filtrar los que NO tienen página web
  sin_web <- datos_filtrados[datos_filtrados$P2532 == 0, ]
  
  # Filtrar los que SÍ tienen página web
  con_web <- datos_filtrados[datos_filtrados$P2532 == 1, ]
  
  # Verificar si el subconjunto sin_web tiene datos y no está vacío
  if (nrow(sin_web) > 0 && sum(!is.na(sin_web$P1010)) > 0) {
    graficar_distribucion(sin_web, "Distribución de Ventas (Sin Página Web)")
  } else {
    print("No hay datos suficientes para los establecimientos sin página web.")
  }
  
  # Verificar si el subconjunto con_web tiene datos y no está vacío
  if (nrow(con_web) > 0 && sum(!is.na(con_web$P1010)) > 0) {
    graficar_distribucion(con_web, "Distribución de Ventas (Con Página Web)")
  } else {
    print("No hay datos suficientes para los establecimientos con página web.")
  }
  
} else {
  print("No hay datos suficientes después del filtrado.")
}
```

# Estimaciones.
```{r echo=FALSE}
# Función para calcular el intervalo de confianza de cualquier variable
calcular_intervalo_confianza <- function(variable, confianza = 0.95) {
  datos_limpios <- na.omit(variable)
  media <- mean(datos_limpios)
  desviacion <- sd(datos_limpios)
  n <- length(datos_limpios)
  error_estandar <- desviacion / sqrt(n)
  error_margen <- qnorm(0.5 + confianza / 2) * error_estandar
  limite_inferior <- media - error_margen
  limite_superior <- media + error_margen
  return(c(limite_inferior, limite_superior))
}

# Calcular intervalos de confianza
intervalo_ventas <- calcular_intervalo_confianza(datos_microestablecimientos$P1010)
intervalo_web <- calcular_intervalo_confianza(datos_microestablecimientos$P2532)
intervalo_computadores_escritorio <- calcular_intervalo_confianza(datos_microestablecimientos$P1087)

# Mostrar los resultados
cat("Intervalo de confianza para el promedio de ventas (95%): [", intervalo_ventas[1], ", ", intervalo_ventas[2], "]\n")
cat("Intervalo de confianza para la proporción de establecimientos con página web (95%): [", intervalo_web[1], ", ", intervalo_web[2], "]\n")
cat("Intervalo de confianza para el número de computadores de escritorio (95%): [", intervalo_computadores_escritorio[1], ", ", intervalo_computadores_escritorio[2], "]\n")


```

# Estrategías.

# Limitaciones u oportunidades.

# Referencias.
